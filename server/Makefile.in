BIN=s3d
LIBS=@SERVER_LIBS@
#LIBS+=		-lGL 			  	# graphics.c
#LIBS+=		-lSDL -lpthread   	# graphics_sdl.c
#LIBS+=		-lglut				# graphics_glut.c

SOURCES= main.c network.c graphics.c error.c user.c process.c proto.c event.c object.c mcp.c navigation.c matrix.c cull.c tcp.c shm.c shm_ringbuf.c 
#SOURCES+=graphics_sdl.c user_sdl.c	# sdl
SOURCES+=graphics_glut.c user_glut.c	# glut
PREFIX=@PREFIX@
INSTALL_PROGRAM=@INSTALL@ -c -s -m 755
INSTALL_DIR=@INSTALL@ -c -d -m 755
INSTALL_DATA=@INSTALL@ -c -m 644
OBJS=$(SOURCES:.c=.o)

CC=@CC@
LD=@CC@
#CFLAGS=-Wall -O2 -ggdb -pg -pedantic
CFLAGS=@CFLAGS@ @DEFS@ -Wall -Wstrict-prototypes -pedantic -ggdb -pg 
LDFLAGS=@LDFLAGS@ -ggdb -pg
#.SUFFIXES: .c

all:	$(BIN)
$(BIN):	$(OBJS)
	$(LD) $(LDFLAGS) $(OBJS) $(LIBS) -o $(BIN)
.c.o:	 global.h config.h
	 $(CC) $(CFLAGS) -c $< -o $@
install:
	$(INSTALL_PROGRAM)  s3d $(PREFIX)/bin
	$(INSTALL_DIR) -d $(PREFIX)/include/s3d
	$(INSTALL_DATA) proto.h $(PREFIX)/include/s3d/
uninstall:
	rm -f $(PREFIX)/bin/s3d
	rm -f $(PREFIX)/include/s3d/proto.h
clean:
	rm -rf $(OBJS) $(BIN) gmon.out
profile: all
	gprof s3d gmon.out
depend:
	makedepend $(CFLAGS) $(SOURCES)
